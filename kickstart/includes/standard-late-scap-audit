
# We don't want the final remediation script to set the system to targeted
sed -i -e "s/SELINUXTYPE=${POLNAME}/SELINUXTYPE=targeted/" /etc/selinux/config

oscap xccdf eval --profile $xccdf_profile \
$tailoring \
--report /root/scap/post/html/report.html \
--results /root/scap/post/html/results.xml \
/usr/share/xml/scap/ssg/content/ssg-${xccdf}-xccdf.xml

oscap xccdf generate fix \
$tailoring \
--result-id xccdf_org.open-scap_testresult_$xccdf_profile \
--template urn:xccdf:fix:script:sh \
/root/scap/post/html/results.xml > /root/scap/post/remediation-script.sh
chmod +x /root/scap/post/remediation-script.sh

sed -i -e "s/targeted/${POLNAME}/" /etc/selinux/config
